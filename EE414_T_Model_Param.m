%--------------------------------------------------------------------
 
function [Xp_Z0, Xs_Z0, K_Z0, phi, psi] = ...
    EE414_T_Model_Param(S_fx)
 
%--------------------------------------------------------------------
% S to Z
% T Model Parameters
% WG BPF Inductive Iris
%--------------------------------------------------------------------
% 03/29/2024 By John J. Burke, PhD, PE
%--------------------------------------------------------------------

Z_Z0 = S_to_Z(S_fx, 1);
Z11_Z0 = Z_Z0(1, 1);
Z21_Z0 = Z_Z0(2, 1);
Zp_Z0 = Z21_Z0;
Xp_Z0 = imag(Zp_Z0);
Zs_Z0 = Z11_Z0-Z21_Z0;
Xs_Z0 = imag(Zs_Z0);
psi = atand(Xs_Z0);
phi = (-1)*( atand(2*Xp_Z0+Xs_Z0) + psi );
K_Z0 = abs(tand(0.5*phi + psi));

%--------------------------------------------------------------------